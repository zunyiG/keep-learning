# 12 Factor

[链接](https://12factor.net/zh_cn)

## 基准代码

- 一份基准代码（Codebase），多份部署（deploy）
- 每个应用只对应一份基准代码 （如果多个应用共享一份代码，可以将其作为依赖去管理）
- 每份部署可以使用其不同的版本 （预发布环境， 生产环境）

git 管理

## 依赖

- 显式声明依赖关系（不会隐式依赖除依赖清单外的类库）

package.json docker隔离

## 配置

- 在环境中存储配置
- 代码与配置分离（如果代码立即开源，也不会泄露敏感信息）

单独的配置文件 config.js, 配置文件可以获取需要的环境变量 process.env.API_PATH
统一的配置读取方法 config('api.path')
nginx 作为接口代理， 代理生产环境接口或者开发mock，本地开发时连接到服务器nginx,
如果是联调再通过koa 去转发前端配置的ip

## 后端服务

- 把后端服务(backing services)当作附加资源
- 对于前端来说，后端服务只是一个url 可以轻松可以替换

## 构建发布与运行

- 严格分离构建和运行
- 构建阶段 是指将代码仓库转化为可执行包的过程 （jekens -> npm run build）
- 发布阶段 会将 `构建的结果` 和当前部署所需 `配置` 相结合，并能够立刻在运行环境中投入使用 (docker image)
- 运行阶段 (dcoker run / k8s)
- 可以轻松的实现回退功能(nginx 映射到不同版本的docker container， images 做好版本管理，版本只能追加一旦发布就不能再修改，只能重新发布一个新的)
- 自动运行阶段， 应用在构建后就不需要人为去管理， 如果宕机可以自动重启

## 进程 *

- 以一个或多个无状态进程运行应用

## 端口绑定 *

- 通过端口绑定(Port binding)来提供服务

## 并发 *

- 通过进程模型进行扩展 （nginx 接口限制）

## 易处理

- 快速启动和优雅终止可最大化健壮性

## 开发环境与线上环境等价

- 尽可能的保持开发，预发布，线上环境相同 (开发环境 也切换为docker container)

## 日志

- 把日志当作事件流
- 数据埋点
- 前端错误报告收集
- 日志分析管理工具，它应该独立于应用之外，自动去截取存储并分析

## 管理进程 *

后台管理任务当作一次性进程运行

--- 
层级结构的重要性
- 代码的层级结构， 统一的层级结构
- 数据的层级结构， 最完成负责与数据对接， 内层做数据的分解展示
